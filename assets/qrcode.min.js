var QRCode=function(n,f){function t(n){this.mode=d.MODE_8BIT_BYTE,this.data=n}function e(n,f){this.typeNumber=n,this.errorCorrectLevel=f,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}function r(n){this.mode=d.MODE_NUMBER,this.data=n}function o(n){this.mode=d.MODE_ALPHA_NUM,this.data=n}function u(n){this.buffer=[],this.length=0,arguments.length?this.put(n,b||8):void 0}function i(n,f){this.totalCount=n.totalCount,this.dataCount=n.dataCount,this.blockList=[];for(var t=0;t<this.totalCount;t++)this.blockList.push(0)}function a(n,f){this.buffer=[],this.length=0,n&&("number"==typeof n?this.put(n,f||8):this.putString(n))}var d=e.QRMode={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8};t.prototype={getLength:function(){return function(n){for(var f=[],t=0;t<n.length;t++){var e=n.charCodeAt(t);e<128?f.push(e):e<2048?(f.push(192|e>>6),f.push(128|63&e)):e>=55296&&e<57344?(e=65536+((1023&e)<<10)+(1023&n.charCodeAt(++t)),f.push(240|e>>18),f.push(128|63&e>>12),f.push(128|63&e>>6),f.push(128|63&e)):(f.push(224|e>>12),f.push(128|63&e>>6),f.push(128|63&e))}return f}(this.data).length},write:function(n){for(var f=0,t=function(n){for(var f=[],t=0;t<n.length;t++){var e=n.charCodeAt(t);e<128?f.push(e):e<2048?(f.push(192|e>>6),f.push(128|63&e)):e>=55296&&e<57344?(e=65536+((1023&e)<<10)+(1023&n.charCodeAt(++t)),f.push(240|e>>18),f.push(128|63&e>>12),f.push(128|63&e>>6),f.push(128|63&e)):(f.push(224|e>>12),f.push(128|63&e>>6),f.push(128|63&e))}return f}(this.data);f<t.length;f++)n.put(t[f],8)}};var c={};c.PAD0=236,c.PAD1=17,e.prototype={addData:function(n,f){var t;if(f=f||"Byte",f instanceof Array)t=n;else switch(f){case"Number":t=new r(n);break;case"AlphaNum":t=new o(n);break;case"Byte":default:t=new t(n)}this.dataList.push(t),this.dataCache=null},isDark:function(n,f){if(0>n||this.moduleCount<=n||0>f||this.moduleCount<=f)throw new Error(n+","+f);return this.modules[n][f]},getModuleCount:function(){return this.moduleCount},make:function(){this.typeNumber<1&&(this.typeNumber=this.getMinimumTypeNumber());for(var n=0;;){if(this.makeImpl(!1,n),this.isDark(0,8))break;if(++n>=8)throw new Error("Unable to find mask pattern.")}},makeImpl:function(n,f){var t=this.moduleCount=4*this.typeNumber+17;this.modules=new Array(t);for(var e=0;e<t;e++){this.modules[e]=new Array(t);for(var r=0;r<t;r++)this.modules[e][r]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(n,f),this.typeNumber>=7&&this.setupTypeNumber(n),null==this.dataCache&&(this.dataCache=this.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,f)},setupPositionProbePattern:function(n,f){for(var t=-1;7>=t;t++)if(!(n+t<=-1||this.moduleCount<=n+t))for(var r=-1;7>=r;r++)f+r<=-1||this.moduleCount<=f+r||(this.modules[n+t][f+r]=0<=t&&t<=6&&(0==r||6==r)||0<=r&&r<=6&&(0==t||6==t)||2<=t&&t<=4&&2<=r&&r<=4?!0:!1)},getMinimumTypeNumber:function(){for(var n=1;n<40;n++){var f=e.getRSBlocks(n,this.errorCorrectLevel)[0];if(this.getLength()+4<=8*(f.dataCount*f.totalCount))return n}return 40},setupTimingPattern:function(){for(var n=8;n<this.moduleCount-8;n++)null==this.modules[n][6]&&(this.modules[n][6]=0==n%2),null==this.modules[6][n]&&(this.modules[6][n]=0==n%2)},setupPositionAdjustPattern:function(){for(var n=e.getPatternPosition(this.typeNumber),f=0;f<n.length;f++)for(var t=0;t<n.length;t++){var r=n[f],o=n[t];if(null==this.modules[r][o])for(var u=-2;2>=u;u++)for(var i=-2;2>=i;i++)this.modules[r+u][o+i]=(-2==u||2==u||-2==i||2==i||0==u&&0==i)?!0:!1}},setupTypeNumber:function(n){for(var f=e.getBCHTypeNumber(this.typeNumber),t=0;18>t;t++){var r=!n&&1==(f>>t&1);this.modules[Math.floor(t/3)][t%3+this.moduleCount-8-3]=r,this.modules[t%3+this.moduleCount-8-3][Math.floor(t/3)]=r}},setupTypeInfo:function(n,f){for(var t=this.errorCorrectLevel<<3|f,r=e.getBCHTypeInfo(t),o=0;15>o;o++){var u=!n&&1==(r>>o&1);6>o?this.modules[o][8]=u:8==o?this.modules[o+1][8]=u:9==o?this.modules[8][this.moduleCount-1]=u:this.modules[8][this.moduleCount-15+o]=u,6>o?this.modules[8][o]=u:8==o?this.modules[this.moduleCount-1][8]=u:9==o?this.modules[8][this.moduleCount-15]=u:this.modules[this.moduleCount-15+o][8]=u}},mapData:function(n,f){for(var t=0,r=this.moduleCount-1,o=this.moduleCount-1,u=this.moduleCount-1;o>0;o-=2){6==o&&o--;for(var i=0;i<this.moduleCount;i++)for(var a=0;a<2;a++)null==this.modules[r][o-a]&&(t<n.length&&(this.modules[r][o-a]=this.getMask(f,r,o-a)?!((1&n[t]>>>7)==1):(1&n[t]>>>7)==1),t++,t>=n.buffer.length&&n.buffer.length>1&&(n.buffer=n.buffer.slice(1),t=0,0==n.buffer.length&&(n.buffer=new Array)),r+=u);r-=u}},createData:function(n,f){for(var t=e.getRSBlocks(n,f),r=new a,o=0;o<this.dataList.length;o++){var u=this.dataList[o];r.put(u.mode,4),r.put(u.getLength(),e.getLengthInBits(u.mode,n)),u.write(r)}var i=0;for(o=0;o<t.length;o++)i+=t[o].dataCount;for(r.getLengthInBits()>8*i&&console.error("code length overflow. ("+r.getLengthInBits()+">"+8*i+")");r.getLengthInBits()+4<=8*i;)r.put(0,4);for(;0!=r.getLengthInBits()%8;)r.putBit(!1);for(;!(r.getLengthInBits()>=8*i&&0==r.getLengthInBits()%8);)r.put(0,8);return e.createBytes(r.buffer,t)}},QRCode=e;var f=j();QRCode.CorrectLevel=f}();
